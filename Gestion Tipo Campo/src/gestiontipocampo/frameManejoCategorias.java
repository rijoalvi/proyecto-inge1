/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * frameManejoCategorias.java
 *
 * Created on 13/04/2009, 11:06:34 PM
 */

package gestiontipocampo;

/**
 *
 * @author Ricardo
 */
import java.util.Vector;
import javax.swing.JOptionPane;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.lang.Integer;



public class frameManejoCategorias extends javax.swing.JFrame {

    /** Creates new form frameManejoCategorias */
    public frameManejoCategorias(String nombre) {
        initComponents();
        labelNombreCategoria.setText(nombre);
        nombreGlobal=nombre;
    }
    public int IDCategoria=0;
        public String nombreGlobal;
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jScrollPane1 = new javax.swing.JScrollPane();
        listInstanciasCategorias = new javax.swing.JList();
        labelNombreCategoria = new javax.swing.JLabel();
        labelElementos = new javax.swing.JLabel();
        botonAgregarElemento = new javax.swing.JButton();
        botonAceptar = new javax.swing.JButton();
        botonCancelar = new javax.swing.JButton();
        botonBorrarElemento = new javax.swing.JButton();
        botonModificarElemento = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setName("Form"); // NOI18N
        addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                formComponentShown(evt);
            }
        });
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jScrollPane1.setName("jScrollPane1"); // NOI18N

        listInstanciasCategorias.setName("listInstanciasCategorias"); // NOI18N
        jScrollPane1.setViewportView(listInstanciasCategorias);

        getContentPane().add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 60, 130, 220));

        org.jdesktop.application.ResourceMap resourceMap = org.jdesktop.application.Application.getInstance(gestiontipocampo.GestionTipoCampoApp.class).getContext().getResourceMap(frameManejoCategorias.class);
        labelNombreCategoria.setText(resourceMap.getString("labelNombreCategoria.text")); // NOI18N
        labelNombreCategoria.setName("labelNombreCategoria"); // NOI18N
        getContentPane().add(labelNombreCategoria, new org.netbeans.lib.awtextra.AbsoluteConstraints(120, 10, -1, -1));

        labelElementos.setText(resourceMap.getString("labelElementos.text")); // NOI18N
        labelElementos.setName("labelElementos"); // NOI18N
        getContentPane().add(labelElementos, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 40, -1, -1));

        botonAgregarElemento.setText(resourceMap.getString("botonAgregarElemento.text")); // NOI18N
        botonAgregarElemento.setName("botonAgregarElemento"); // NOI18N
        botonAgregarElemento.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                botonAgregarElementoMouseClicked(evt);
            }
        });
        botonAgregarElemento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonAgregarElementoActionPerformed(evt);
            }
        });
        getContentPane().add(botonAgregarElemento, new org.netbeans.lib.awtextra.AbsoluteConstraints(350, 60, 120, -1));

        botonAceptar.setText(resourceMap.getString("botonAceptar.text")); // NOI18N
        botonAceptar.setName("botonAceptar"); // NOI18N
        botonAceptar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonAceptarActionPerformed(evt);
            }
        });
        getContentPane().add(botonAceptar, new org.netbeans.lib.awtextra.AbsoluteConstraints(260, 320, -1, -1));

        botonCancelar.setText(resourceMap.getString("botonCancelar.text")); // NOI18N
        botonCancelar.setName("botonCancelar"); // NOI18N
        botonCancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonCancelarActionPerformed(evt);
            }
        });
        getContentPane().add(botonCancelar, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 320, -1, -1));

        botonBorrarElemento.setText(resourceMap.getString("botonBorrarElemento.text")); // NOI18N
        botonBorrarElemento.setName("botonBorrarElemento"); // NOI18N
        botonBorrarElemento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonBorrarElementoActionPerformed(evt);
            }
        });
        getContentPane().add(botonBorrarElemento, new org.netbeans.lib.awtextra.AbsoluteConstraints(350, 140, 120, -1));

        botonModificarElemento.setText(resourceMap.getString("botonModificarElemento.text")); // NOI18N
        botonModificarElemento.setName("botonModificarElemento"); // NOI18N
        botonModificarElemento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonModificarElementoActionPerformed(evt);
            }
        });
        getContentPane().add(botonModificarElemento, new org.netbeans.lib.awtextra.AbsoluteConstraints(350, 100, 120, -1));

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void botonAceptarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonAceptarActionPerformed
        this.setVisible(false);
    }//GEN-LAST:event_botonAceptarActionPerformed

    private void botonCancelarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonCancelarActionPerformed
        this.dispose();
    }//GEN-LAST:event_botonCancelarActionPerformed

    private void botonAgregarElementoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonAgregarElementoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botonAgregarElementoActionPerformed

    private void botonModificarElementoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonModificarElementoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botonModificarElementoActionPerformed

    private void botonBorrarElementoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonBorrarElementoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botonBorrarElementoActionPerformed

    private void formComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_formComponentShown
        // TODO add your handling code here:
        ControladorBD buscador= new ControladorBD();
        buscador.doUpdate("INSERT INTO TIPOCATEGORIA (nombre, descripcion) VALUES ('"+labelNombreCategoria.getText()+"','No establecida')");
        refrescarLista();

    }//GEN-LAST:event_formComponentShown

    private void botonAgregarElementoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botonAgregarElementoMouseClicked

        String elemento = JOptionPane.showInputDialog(null, "Digite el elemento a agregar", "Nuevo elemento", JOptionPane.QUESTION_MESSAGE);// TODO add your handling code here:
        ControladorBD buscador= new ControladorBD();
        //buscador.doUpdate("INSERT INTO TIPOCATEGORIA (nombre, descripcion) VALUES ('"+labelNombreCategoria.getText()+"','No establecida')");
        //refrescarLista();
        
          //     ControladorBD buscador = new ControladorBD();



            try {
                //ResultSet resultado = buscador.getResultSet("SELECT  ID FROM TIPOCATEGORIA order by ID desc limit 1");
                ResultSet resultado = buscador.getResultSet("SELECT  ID FROM TIPOCATEGORIA where nombre='"+nombreGlobal+"'");
                int contador=0;
                while (resultado.next()) {
                    //vectorValores.add(new MiDato(resultado.getObject("nombre").toString(),Integer.parseInt(resultado.getObject("ID").toString())));
                    System.out.println(resultado.getObject("ID").toString());
                    this.IDCategoria=Integer.parseInt(resultado.getObject("ID").toString());
                    contador++;
                }
            } catch (SQLException e) {
                System.out.println("*SQL Exception: *" + e.toString());
            }

        buscador.doUpdate("INSERT INTO INSTANCIACATEGORIA (IDTipoCategoria, valor) VALUES ('"+this.IDCategoria+"','"+elemento.toString()+"')");
        refrescarLista();




    }//GEN-LAST:event_botonAgregarElementoMouseClicked




    public void refrescarLista(){

/*Vector listaInstancias = new Vector();
listaInstancias.add("uno");
listaInstancias.add("dos");
listaInstancias.add("tres");*/

        Modelo  miModelo = new Modelo();
        listInstanciasCategorias.setListData(miModelo.getModeloDeCombo("Select ic.ID , ic.valor as nombre from TIPOCATEGORIA tc, INSTANCIACATEGORIA ic where ic.IDTIpoCategoria=tc.ID and tc.nombre like '"+labelNombreCategoria.getText().trim()+"'"));


       // listInstanciasCategorias.setListData(listaInstancias);

    }
    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new frameManejoCategorias("").setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton botonAceptar;
    private javax.swing.JButton botonAgregarElemento;
    private javax.swing.JButton botonBorrarElemento;
    private javax.swing.JButton botonCancelar;
    private javax.swing.JButton botonModificarElemento;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel labelElementos;
    private javax.swing.JLabel labelNombreCategoria;
    private javax.swing.JList listInstanciasCategorias;
    // End of variables declaration//GEN-END:variables

}
